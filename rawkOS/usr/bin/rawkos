#!/usr/bin/env -S just --justfile

[private]
default:
	@just --choose --justfile {{justfile()}}

# Make new installs a little easier
init: nix-install code-init nix-home set-default-shell

install-flatpaks:
	flatpak install com.discordapp.Discord
	flatpak install com.slack.Slack
	flatpak install org.wezfurlong.wezterm
	flatpak install us.zoom.Zoom
	flatpak install --user --from https://nightly.gnome.org/repo/appstream/org.gnome.Ptyxis.Devel.flatpakref

# Setup the default shell
set-default-shell:
	sudo usermod --shell $(which nu) $(whoami)

nix-home:
	nix run home-manager -- switch --flake ${HOME}/Code/src/github.com/rawkode/rawkode/nix-home

# Make Nix available via Determinate Systems installer
nix-install:
	curl --proto '=https' --tlsv1.2 -sSf -L https://install.determinate.systems/nix | sh -s -- install

# Create Code directory and clone rawkode and RawkodeAcademy repositories
code-init:
	mkdir -p ${HOME}/Code/src/github.com/{rawkode,RawkodeAcademy}
	git clone git@github.com:rawkode/rawkode.git ${HOME}/Code/src/github.com/rawkode/rawkode
	git clone git@github.com:RawkodeAcademy/RawkodeAcademy.git ${HOME}/Code/src/github.com/RawkodeAcademy/RawkodeAcademy

# Let's fetch the latest and greatest!
upgrade:
	rpm-ostree upgrade
